# Publishing Policy

## –¶–µ–ª—å

–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–π –≤ ArangoDB, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–ª–∏ —Ç–µ—Å—Ç–æ–≤—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º.

---

## 1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

### 1.1 QA Approval –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

**–ü—Ä–∞–≤–∏–ª–æ:** –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `approved=true` –≤ QA –æ—Ç—á—ë—Ç–µ.

**–§–∞–π–ª QA:** `data/qa/<methodology_id>.json`

**–ü—Ä–∏–º–µ—Ä QA –æ—Ç—á—ë—Ç–∞:**
```json
{
  "methodology_id": "accounting-basics-test",
  "approved": true,
  "overall_score": 8.5,
  "reviewed_at": "2025-12-13T10:00:00Z",
  "reviewer": "Agent D",
  "issues": []
}
```

**–û–±—Ö–æ–¥ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):** `--skip-qa` —Ñ–ª–∞–≥

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** `--skip-qa` –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤ dev-–æ–∫—Ä—É–∂–µ–Ω–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –í production —ç—Ç–æ—Ç —Ñ–ª–∞–≥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫–ª—é—á—ë–Ω.

---

### 1.2 Source Lineage –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

**–ü—Ä–∞–≤–∏–ª–æ:** –ö–∞–∂–¥—ã–π –¥–æ–∫—É–º–µ–Ω—Ç (entity/edge) –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª–µ `source` —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è.

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:**
```python
source = {
    "repo": "financial-methodologies-kb",  # –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    "ref": "main",                          # Git branch/commit/tag
    "path": "data/methodologies/...",      # –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –∫ YAML
    "agent": "Agent E"                      # –ê–≥–µ–Ω—Ç, —Å–æ–∑–¥–∞–≤—à–∏–π –¥–æ–∫—É–º–µ–Ω—Ç
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –±–µ–∑ `source` —Å—á–∏—Ç–∞—é—Ç—Å—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ –∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å—Å—è.

---

### 1.3 Stable _key –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

**–ü—Ä–∞–≤–∏–ª–æ:** `_key` –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–º** –∏ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å entity ID.

**–ü—Ä–∏–º–µ—Ä—ã:**
- Methodology: `_key = methodology_id` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `accounting-basics-test`)
- Stage: `_key = stage_id` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `stage_001`)
- Tool: `_key = tool_id`
- Indicator: `_key = indicator_id`
- Rule: `_key = rule_id`
- Term: `_key = term_id`

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**
- ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (–ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è = update, –Ω–µ duplicate)
- ‚úÖ –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ edge `_from/_to` –∑–Ω–∞—á–µ–Ω–∏—è
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –ë–î

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ï—Å–ª–∏ `_key != entity_id`, –ø—É–±–ª–∏–∫–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞.

---

## 2. –ü—Ä–∞–≤–∏–ª–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### 2.1 –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

**–ü—Ä–∞–≤–∏–ª–æ:** –ò—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `financial-methodologies-kb`.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
data/
‚îú‚îÄ‚îÄ methodologies/          # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ YAML –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ <id>.yaml
‚îú‚îÄ‚îÄ glossary/               # –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–π –≥–ª–æ—Å—Å–∞—Ä–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ *.yaml
‚îî‚îÄ‚îÄ qa/                     # QA –æ—Ç—á—ë—Ç—ã Agent D
    ‚îî‚îÄ‚îÄ <id>.json

docs/
‚îî‚îÄ‚îÄ methodologies/          # Markdown –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îî‚îÄ‚îÄ <id>/
```

**–ó–∞–ø—Ä–µ—â–µ–Ω–æ:** –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∏–∑ –¥—Ä—É–≥–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –±–µ–∑ explicit approval.

---

### 2.2 –î–µ–ø–ª–æ–π —Ç–æ–ª—å–∫–æ –∏–∑ main branch

**–ü—Ä–∞–≤–∏–ª–æ:** Production –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∞ —Ç–æ–ª—å–∫–æ —Å `ref=main` (–∏–ª–∏ tagged release).

**–î–ª—è dev/staging:** –î–æ–ø—É—Å—Ç–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å feature branches, –Ω–æ —Å —è–≤–Ω–æ–π –º–∞—Ä–∫–∏—Ä–æ–≤–∫–æ–π:
- `status=draft` –¥–ª—è –≤—Å–µ—Ö entities
- –û—Ç–¥–µ–ª—å–Ω–∞—è dev –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

---

### 2.3 Version control –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

**–ü—Ä–∞–≤–∏–ª–æ:** –ö–∞–∂–¥–∞—è –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å `version` –ø–æ–ª–µ.

**–§–æ—Ä–º–∞—Ç:** Semantic Versioning (`major.minor.patch`)

**–ü—Ä–∏–º–µ—Ä:**
```yaml
metadata:
  id: accounting-basics-test
  version: "1.0.0"
  created_at: "2025-12-13T10:00:00Z"
  updated_at: "2025-12-13T15:00:00Z"
```

**–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏:**
- Patch (`1.0.1`): –û–ø–µ—á–∞—Ç–∫–∏, –º–µ–ª–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- Minor (`1.1.0`): –ù–æ–≤—ã–µ stages/tools, –Ω–æ –Ω–µ breaking changes
- Major (`2.0.0`): –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —É–¥–∞–ª–µ–Ω–∏–µ stages

---

## 3. –ü—Ä–æ—Ü–µ—Å—Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

### 3.1 Pipeline

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Agent A    ‚îÇ  Extract ‚Üí blocks.jsonl
‚îÇ  (Extractor)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Agent B    ‚îÇ  Outline ‚Üí outline.yaml
‚îÇ  (Outline)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Agent C    ‚îÇ  Compile ‚Üí YAML + MD
‚îÇ  (Compiler) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Agent D    ‚îÇ  QA Review ‚Üí approved: true/false
‚îÇ  (QA)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚Üì (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ approved=true)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Agent E    ‚îÇ  Publish ‚Üí ArangoDB
‚îÇ  (Publisher)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Agent F    ‚îÇ  PR ‚Üí GitHub
‚îÇ  (PR)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏:**
1. **Agent D ‚Üí Agent E:** –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ `approved=false`
2. **Agent E ‚Üí ArangoDB:** –í–∞–ª–∏–¥–∞—Ü–∏—è lineage + stable _key
3. **Agent F ‚Üí GitHub:** PR —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è approved –∫–æ–Ω—Ç–µ–Ω—Ç–∞

---

### 3.2 –ö–æ–º–∞–Ω–¥—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

**Development (with QA bypass):**
```bash
python -m pipeline.agents.agent_e <methodology_id> --skip-qa
```

**Production (requires QA approval):**
```bash
python -m pipeline.agents.agent_e <methodology_id>
```

**Dry-run (no DB writes):**
```bash
python -m pipeline.agents.agent_e <methodology_id> --dry-run
```

---

### 3.3 Rollback policy

**–ï—Å–ª–∏ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ —Å –æ—à–∏–±–∫–∞–º–∏:**

1. **–ù–µ —É–¥–∞–ª—è—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã** (–ª–æ–º–∞–µ—Ç history)
2. **–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å:** `status=deprecated` –∏–ª–∏ `status=archived`
3. **–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é** —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º version

**–ö–æ–º–∞–Ω–¥–∞ deprecation:**
```python
# –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ deprecated
FOR m IN methodologies
    FILTER m._key == "bad-methodology-id"
    UPDATE m WITH { status: "deprecated", deprecated_at: DATE_NOW() } IN methodologies
```

---

## 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞—É–¥–∏—Ç

### 4.1 –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- **Total methodologies:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–π
- **Status breakdown:** `active` / `draft` / `deprecated`
- **Source breakdown:** –ò–∑ –∫–∞–∫–æ–≥–æ `source.repo` –ø—Ä–∏—à–ª–∏ –¥–∞–Ω–Ω—ã–µ
- **Agent breakdown:** –ö–∞–∫–∏–µ –∞–≥–µ–Ω—Ç—ã –ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ–ª—å–∫–æ Agent E)
- **QA approved ratio:** % –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–π —Å `approved=true`

**AQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –∞—É–¥–∏—Ç–∞:**
```aql
FOR m IN methodologies
    COLLECT status = m.status, repo = m.source.repo, agent = m.source.agent WITH COUNT INTO total
    RETURN { status, repo, agent, total }
```

---

### 4.2 Alert triggers

**üö® –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:**
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è –±–µ–∑ `source.repo = financial-methodologies-kb`
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å `approved=false` (–µ—Å–ª–∏ –Ω–µ dev)
- Duplicate `_key` (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞, –Ω–æ –µ—Å–ª–∏ —Å–ª—É—á–∏–ª–∞—Å—å ‚Äî bug)
- Orphaned edges (edges —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ entities)

**‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:**
- Glossary stub —Å–æ–∑–¥–∞–Ω (`status=needs_definition`)
- QA score < 5.0 (low quality)
- Empty descriptions –≤ stages/tools/indicators

---

## 5. –ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Ä—É—à–µ–Ω–∏–π –∏ –¥–µ–π—Å—Ç–≤–∏—è

| –ù–∞—Ä—É—à–µ–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|-----------|----------|
| `approved=false` | ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é, –≤–µ—Ä–Ω—É—Ç—å –Ω–∞ QA |
| `source.repo != canonical` | ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, —Ç—Ä–µ–±–æ–≤–∞—Ç—å —è–≤–Ω–æ–≥–æ approval |
| `_key != entity_id` | ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ Agent E |
| Missing `version` | ‚ö†Ô∏è Warning, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å default "0.0.1" |
| Empty `description` | ‚ö†Ô∏è Warning, –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å (QA issue) |
| Glossary stub created | ‚ÑπÔ∏è Info, –¥–æ–±–∞–≤–∏—Ç—å –≤ QA warnings |

---

## 6. Governance

**Ownership:** @leval907 (maintainer)

**Review process:**
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ pipeline –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ PR review
- Agent E updates —Ç—Ä–µ–±—É—é—Ç regression testing (9-point checklist)
- Schema changes —Ç—Ä–µ–±—É—é—Ç migration plan

**Contact:** –í–æ–ø—Ä–æ—Å—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ GitHub Issues —Å –ª–µ–π–±–ª–æ–º `publishing-policy`

---

**Version:** 1.0.0  
**Last Updated:** 2025-12-13  
**Status:** Active
